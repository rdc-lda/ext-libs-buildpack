#!/bin/bash

build_path=$1
cache_path=$2
deps_path=$3
index=$4

DIR="$( cd "$( dirname "${BASH_SOURCE[0]}" )" >/dev/null 2>&1 && pwd )"

JQ_BINARY=${DIR}/../util/jq-linux64

if [ ! -z "$ELBP_CONFIG_LIB_LOCATIONS" ]; then

    echo '-----> External Library Buildpack v1.0.0 | https://github.com/rdc-lda/ext-libs-buildpack.git'
    echo '-----> Downloading external libraries:'
    mkdir -p $deps_path/ext_libs

    for url in $(echo $ELBP_CONFIG_LIB_LOCATIONS | $JQ_BINARY -r '.[]'); do
       echo "       - $url"
       filename=$(echo "${url##*/}")
       curl -s $url --output $deps_path/ext_libs/$filename
    done

else
    echo '-----> No external libraries found for downloading, skipping.'
    exit 0
fi